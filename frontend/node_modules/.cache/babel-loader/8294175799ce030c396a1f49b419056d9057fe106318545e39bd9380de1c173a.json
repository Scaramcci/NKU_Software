{"ast":null,"code":"var _jsxFileName = \"D:\\\\\\u6587\\u96C5\\u7AF9\\\\\\u4F5C\\u4E1A\\\\\\u5927\\u4E09\\u4E0B\\\\\\u8F6F\\u4EF6\\u5DE5\\u7A0B\\\\NKU_Software\\\\frontend\\\\src\\\\components\\\\Layout\\\\index.jsx\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { Layout, Menu } from 'antd';\nimport { useNavigate, Outlet, useLocation } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport { InfoCircleOutlined, BulbOutlined, EnvironmentOutlined, DatabaseOutlined, UsergroupAddOutlined, UserOutlined, LogoutOutlined } from '@ant-design/icons';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  Header,\n  Sider,\n  Content\n} = Layout;\nconst MainLayout = () => {\n  _s();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const {\n    user\n  } = useSelector(state => state.auth);\n  const role = (user === null || user === void 0 ? void 0 : user.role) || 'user'; // fallback 防止未登录\n\n  // 菜单配置（根据角色严格区分）\n  const rawMenuItems = [{\n    key: '/main-info',\n    label: '主要信息',\n    icon: /*#__PURE__*/_jsxDEV(InfoCircleOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 13\n    }, this),\n    roles: ['user', 'farmer', 'admin']\n  }, {\n    key: '/smart-center',\n    label: '智能中心',\n    icon: /*#__PURE__*/_jsxDEV(BulbOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 13\n    }, this),\n    roles: ['user', 'farmer', 'admin']\n  }, {\n    key: '/underwater-system',\n    label: '水下系统',\n    icon: /*#__PURE__*/_jsxDEV(EnvironmentOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 13\n    }, this),\n    roles: ['farmer', 'admin'] // ❌ 不含 user\n  }, {\n    key: '/data-center',\n    label: '数据中心',\n    icon: /*#__PURE__*/_jsxDEV(DatabaseOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 13\n    }, this),\n    roles: ['admin'] // ❌ 仅管理员\n  }, {\n    key: '/admin-user-management',\n    label: '管理员管理',\n    icon: /*#__PURE__*/_jsxDEV(UsergroupAddOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 13\n    }, this),\n    roles: ['admin']\n  }, {\n    key: '/profile',\n    label: '个人中心',\n    icon: /*#__PURE__*/_jsxDEV(UserOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }, this),\n    roles: ['user', 'farmer', 'admin']\n  }, {\n    key: '/logout',\n    label: '退出登录',\n    icon: /*#__PURE__*/_jsxDEV(LogoutOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }, this),\n    roles: ['user', 'farmer', 'admin'],\n    onClick: () => {\n      localStorage.removeItem('authToken');\n      localStorage.removeItem('currentUser');\n      navigate('/login');\n    }\n  }];\n\n  // 根据用户角色过滤可见菜单项\n  const menuItems = rawMenuItems.filter(item => item.roles.includes(role)).map(({\n    key,\n    label,\n    icon,\n    onClick\n  }) => ({\n    key,\n    label,\n    icon,\n    onClick: onClick || (() => navigate(key))\n  }));\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    style: {\n      minHeight: '100vh'\n    },\n    children: [/*#__PURE__*/_jsxDEV(Sider, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: 64,\n          margin: 16,\n          color: '#fff',\n          fontSize: 20,\n          fontWeight: 'bold',\n          textAlign: 'center',\n          lineHeight: '32px'\n        },\n        children: \"\\u667A\\u6167\\u7267\\u573A\\u7CFB\\u7EDF\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Menu, {\n        theme: \"dark\",\n        mode: \"inline\",\n        selectedKeys: [location.pathname],\n        onClick: ({\n          key\n        }) => {\n          const menuItem = menuItems.find(item => item.key === key);\n          menuItem === null || menuItem === void 0 ? void 0 : menuItem.onClick();\n        },\n        items: menuItems\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Layout, {\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        style: {\n          padding: '0 24px',\n          background: '#fff',\n          display: 'flex',\n          justifyContent: 'flex-end',\n          alignItems: 'center',\n          fontSize: 16\n        },\n        children: [\"\\u6B22\\u8FCE\\uFF0C\", (user === null || user === void 0 ? void 0 : user.displayName) || (user === null || user === void 0 ? void 0 : user.username) || '用户', \"\\uFF08\", role, \"\\uFF09\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Content, {\n        style: {\n          margin: '24px 16px',\n          padding: 24,\n          background: '#fff'\n        },\n        children: /*#__PURE__*/_jsxDEV(Outlet, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n};\n_s(MainLayout, \"GJPzNh4w2AFwatwER+UNMdwMllc=\", false, function () {\n  return [useNavigate, useLocation, useSelector];\n});\n_c = MainLayout;\nexport default MainLayout;\nvar _c;\n$RefreshReg$(_c, \"MainLayout\");","map":{"version":3,"names":["React","Layout","Menu","useNavigate","Outlet","useLocation","useSelector","InfoCircleOutlined","BulbOutlined","EnvironmentOutlined","DatabaseOutlined","UsergroupAddOutlined","UserOutlined","LogoutOutlined","jsxDEV","_jsxDEV","Header","Sider","Content","MainLayout","_s","navigate","location","user","state","auth","role","rawMenuItems","key","label","icon","fileName","_jsxFileName","lineNumber","columnNumber","roles","onClick","localStorage","removeItem","menuItems","filter","item","includes","map","style","minHeight","children","height","margin","color","fontSize","fontWeight","textAlign","lineHeight","theme","mode","selectedKeys","pathname","menuItem","find","items","padding","background","display","justifyContent","alignItems","displayName","username","_c","$RefreshReg$"],"sources":["D:/文雅竹/作业/大三下/软件工程/NKU_Software/frontend/src/components/Layout/index.jsx"],"sourcesContent":["import React from 'react';\nimport { Layout, Menu } from 'antd';\nimport { useNavigate, Outlet, useLocation } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport {\n  InfoCircleOutlined,\n  BulbOutlined,\n  EnvironmentOutlined,\n  DatabaseOutlined,\n  UsergroupAddOutlined,\n  UserOutlined,\n  LogoutOutlined\n} from '@ant-design/icons';\n\nconst { Header, Sider, Content } = Layout;\n\nconst MainLayout = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const { user } = useSelector(state => state.auth);\n  const role = user?.role || 'user'; // fallback 防止未登录\n\n  // 菜单配置（根据角色严格区分）\n  const rawMenuItems = [\n    {\n      key: '/main-info',\n      label: '主要信息',\n      icon: <InfoCircleOutlined />,\n      roles: ['user', 'farmer', 'admin']\n    },\n    {\n      key: '/smart-center',\n      label: '智能中心',\n      icon: <BulbOutlined />,\n      roles: ['user', 'farmer', 'admin']\n    },\n    {\n      key: '/underwater-system',\n      label: '水下系统',\n      icon: <EnvironmentOutlined />,\n      roles: ['farmer', 'admin'] // ❌ 不含 user\n    },\n    {\n      key: '/data-center',\n      label: '数据中心',\n      icon: <DatabaseOutlined />,\n      roles: ['admin'] // ❌ 仅管理员\n    },\n    {\n      key: '/admin-user-management',\n      label: '管理员管理',\n      icon: <UsergroupAddOutlined />,\n      roles: ['admin']\n    },\n    {\n      key: '/profile',\n      label: '个人中心',\n      icon: <UserOutlined />,\n      roles: ['user', 'farmer', 'admin']\n    },\n    {\n      key: '/logout',\n      label: '退出登录',\n      icon: <LogoutOutlined />,\n      roles: ['user', 'farmer', 'admin'],\n      onClick: () => {\n        localStorage.removeItem('authToken');\n        localStorage.removeItem('currentUser');\n        navigate('/login');\n      }\n    }\n  ];\n\n  // 根据用户角色过滤可见菜单项\n  const menuItems = rawMenuItems\n    .filter(item => item.roles.includes(role))\n    .map(({ key, label, icon, onClick }) => ({\n      key,\n      label,\n      icon,\n      onClick: onClick || (() => navigate(key))\n    }));\n\n  return (\n    <Layout style={{ minHeight: '100vh' }}>\n      <Sider>\n        <div style={{\n          height: 64,\n          margin: 16,\n          color: '#fff',\n          fontSize: 20,\n          fontWeight: 'bold',\n          textAlign: 'center',\n          lineHeight: '32px'\n        }}>\n          智慧牧场系统\n        </div>\n        <Menu\n          theme=\"dark\"\n          mode=\"inline\"\n          selectedKeys={[location.pathname]}\n          onClick={({ key }) => {\n            const menuItem = menuItems.find(item => item.key === key);\n            menuItem?.onClick();\n          }}\n          items={menuItems}\n        />\n      </Sider>\n      <Layout>\n        <Header style={{\n          padding: '0 24px',\n          background: '#fff',\n          display: 'flex',\n          justifyContent: 'flex-end',\n          alignItems: 'center',\n          fontSize: 16\n        }}>\n          欢迎，{user?.displayName || user?.username || '用户'}（{role}）\n        </Header>\n        <Content style={{ margin: '24px 16px', padding: 24, background: '#fff' }}>\n          <Outlet />\n        </Content>\n      </Layout>\n    </Layout>\n  );\n};\n\nexport default MainLayout;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}